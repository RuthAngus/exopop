\documentclass[12pt,preprint]{aastex}

% has to be before amssymb it seems
\usepackage{color,hyperref}
\definecolor{linkcolor}{rgb}{0,0,0.5}
\hypersetup{colorlinks=true,linkcolor=linkcolor,citecolor=linkcolor,
            filecolor=linkcolor,urlcolor=linkcolor}

\usepackage{url}
\usepackage{algorithmic,algorithm}
\usepackage{multirow}

\usepackage{listings}
\definecolor{lbcolor}{rgb}{0.9,0.9,0.9}
\lstset{language=Python,
        basicstyle=\footnotesize\ttfamily,
        showspaces=false,
        showstringspaces=false,
        tabsize=2,
        breaklines=false,
        breakatwhitespace=true,
        identifierstyle=\ttfamily,
        keywordstyle=\bfseries\color[rgb]{0.133,0.545,0.133},
        commentstyle=\color[rgb]{0.133,0.545,0.133},
        stringstyle=\color[rgb]{0.627,0.126,0.941},
    }

\input{vars}

\begin{document}

\title{%
    Exoplanet population inferences
    from a hierarchical model
    of the \kepler\ ``Object of Interest'' Catalog
}

\newcommand{\nyu}{2}
\newcommand{\mpia}{3}
\author{%
    Daniel~Foreman-Mackey\altaffilmark{1,\nyu},
    David~W.~Hogg\altaffilmark{\nyu,\mpia},
    \etal
}
\altaffiltext{1}{To whom correspondence should be addressed:
                        \url{danfm@nyu.edu}}
\altaffiltext{\nyu}{Center for Cosmology and Particle Physics,
                        Department of Physics, New York University,
                        4 Washington Place, New York, NY, 10003, USA}
\altaffiltext{\mpia}{Max-Planck-Institut f\"ur Astronomie,
                        K\"onigstuhl 17, D-69117 Heidelberg, Germany}

\begin{abstract}
The catalog of \kepler\ Objects of Interest (KOI) is a list of putative periodic exoplanet transit signals
  discovered in the photometric data from the \kepler Satellite.
In principle this catalog contains a wealth of statistical information about the full population of exoplanets.
Here we construct a model of the population that explains the content of the catalog.
Our approach is novel in that
  it takes the form of a rigorous (if approximate) hierarchical Bayesian inference,
  it includes a parameterization of a non-trivial selection function (incompleteness),
  and we fully marginalize out all latent and nuisance parameters using sampling.
Because the model is properly hierarchical,
  it can be constrained by multiple data sources;
  we demonstrate this by adding the Solar System as a constraint,
  but extensions to radial velocity, direct detection, and astrometric surveys would also be straightforward.
Approximations abound:
  Simple parameterized forms are assumed for the multivariate distribution of exoplanet parameters,
  incompleteness is assumed to depend only on a scalar related to signal-to-noise,
  and the KOI catalog is assumed to be dominated by real (not false-positive) exoplanet signals.
We find XXX and YYY.
\end{abstract}

\keywords{%
methods:statistical
}

\section{Introduction}


\section{A toy model}

We start by assuming that ever target star has some $K$ orbiting planets.
Most of these planets are unobserved because they are two (2) small to be
detectable or because of geometry.
The graphical model in \fig{gm} is a sketch of the hypothetical generative
procedure for a catalog of exoplanet observations.
The way it is shown, this model is extremely general but we will consider a
very specific form here.
The parameters of this model are listed and described in \tab{parameters}.

Using this model, we want to find---conditioned on the catalog of exoplanet
candidates---joint constraints on the parameters describing the population of
exoplanets and the selection function of the survey.
To this end, we need to be able to efficiently marginalize over the parameters
of all of the exoplanet systems (observed and unobserved) to compute the
marginalized likelihood function
\begin{eqnarray}
p(\planetobs,\stellarobs,\isobs\,|\,\population,\selection) &=&
\prod_{n=1}^N \int \left [
p(\stellar_n)\,p(\stellarobs_n\,|\,\stellar_n) \,
 \prod_{k=1}^K
p(\planetobs_{kn},\isobs_{kn}\,|\,\stellar_n,\population,\selection)\right ]
\dd \stellar_n
\end{eqnarray}
where
\begin{eqnarray}\eqlabel{planet-marg}
p(\planetobs_{kn},\isobs_{kn}\,|\,\stellar_n,\population,\selection) &=&
\int
p(\planet_{kn}\,|\,\population) \,
p(\planetobs_{kn}\,|\,\planet_{kn},\stellar_{n}) \,
p(\isobs_{kn}\,|\,\planet_{kn},\stellar_{n},\selection)
\dd \planet_{kn} \quad.
\end{eqnarray}

We can evaluate the integral in \eq{planet-marg} using importance sampling.
If the exoplanet is not observed ($\isobs_{kn}=0$), the most sensible proposal
density is simply $\tilde{p}(\planet_{kn})=p(\planet_{kn}\,|\,\population)$
and the integral becomes
\begin{eqnarray}
p(\planetobs_{kn},\isobs_{kn}\,|\,\stellar_n,\population,\selection) &=&
\frac{1}{\sum_l \tilde{p}(x_l)}\,\sum_l
p(\isobs_{kn}\,|\,\planet_{kn}=x_l,\stellar_{n},\selection)
\end{eqnarray}
for $x_l \sim p(\planet_{kn}\,|\,\population)$.

\begin{figure}[htbp]
\begin{center}
    \includegraphics{gm.pdf}
\end{center}
\caption{%
\figlabel{gm}}
\end{figure}

\begin{deluxetable}{ccl}
\tablecaption{%
A description of the model parameters.
\tablabel{parameters}}
\tablewidth{0pt}
\tablehead{& & \colhead{Description}}
\startdata
\multirow{3}{*}{\population}
& $\population_\period$ & The period distribution \\
& $\population_\radius$ & The exoplanet radius distribution \\
& $\population_\relincl$ & The relative inclination distribution \\
\hline
\selection & --- & The parameters of the catalog selection function \\
\hline
$\isobs_{kn}$ & --- & A flag indicating the presence of exoplanet $k$ orbiting
star $n$ in the catalog \\
\hline
\multirow{3}{*}{$\planet_{kn}$}
& $\period_{kn}$ & The period of exoplanet $k$ orbiting star $n$ (or null) \\
& $\radius_{kn}$ & The exoplanet's radius \\
& $\relincl_{kn}$ & The inclination of this orbit away from the systemic mean \\
\hline
\multirow{3}{*}{$\planetobs_{kn}$}
& $\periodobs_{kn}$ & The observed exoplanet period and uncertainty \\
& $(\rorobs)_{kn}$ & The observed radius ratio and uncertainty \\
& $\impactobs_{kn}$ & A constraint on the observed impact parameter \\
\hline
\multirow{4}{*}{$\stellar_{n}$}
& $\smass_{n}$ & The mass of star $n$ \\
& $\sradius_{n}$ & The radius of star $n$ \\
& $\snoise_{n}$ & The ``variability'' of star $n$ \\
& $\incl_{n}$ & The mean inclination of the exoplanets in the system $n$ \\
\hline
\multirow{2}{*}{$\stellarobs_{n}$}
& $\sloggobs_{n}$ & The observed surface gravity (and uncertainty) of star $n$ \\
& $\snoiseobs_{n}$ & The estimated variability of star $n$ \\
\enddata
\end{deluxetable}

\acknowledgments
SAMSI. %
It is a pleasure to thank
    \ldots
for helpful contributions to the ideas and code presented here.
This project was partially supported by the NSF (grant AST-0908357), and NASA
(grant NNX08AJ48G).

\newcommand{\arxiv}[1]{\href{http://arxiv.org/abs/#1}{arXiv:#1}}
\begin{thebibliography}{}\raggedright

\bibitem[Fang \& Margot(2012)]{fang}
Fang, J., \& Margot, J.-L.\ 2012, \apj, 761, 92
\arxiv{1207.5250}

\bibitem[Tremaine \& Dong(2012)]{tremaine}
Tremaine, S., \& Dong, S.\ 2012, \aj, 143, 94
\arxiv{1106.5403}

\end{thebibliography}

\end{document}
